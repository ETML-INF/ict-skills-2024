"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = storeTestRun;

var _fs = _interopRequireDefault(require("fs"));

var _path = _interopRequireDefault(require("path"));

var _uniqid = _interopRequireDefault(require("uniqid"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

/**
 * Store a test run in a history file
 */
function storeTestRun(config, testRun) {
  const historyDir = _path.default.resolve(config.getProjectRoot(), '.history');

  const historyFile = _path.default.resolve(historyDir, `${(0, _uniqid.default)()}.json`); // create history dir if it doesn't exist


  if (!_fs.default.existsSync(historyDir)) {
    _fs.default.mkdirSync(historyDir);
  } // write history file


  _fs.default.writeFileSync(historyFile, JSON.stringify({
    time: Math.round(new Date().getTime() / 1000),
    ...testRun.toJSON()
  }, undefined, 2));
}